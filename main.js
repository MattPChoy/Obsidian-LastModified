"use strict";var d=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var y=(s,e)=>{for(var t in e)d(s,t,{get:e[t],enumerable:!0})},f=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of c(e))!u.call(s,a)&&a!==t&&d(s,a,{get:()=>e[a],enumerable:!(i=l(e,a))||i.enumerable});return s};var m=s=>f(d({},"__esModule",{value:!0}),s);var S={};y(S,{default:()=>o});module.exports=m(S);var n=require("obsidian"),M={propertyName:"Modified"},o=class extends n.Plugin{constructor(){super(...arguments);this.processingFiles=new Set}async onload(){this.settings=Object.assign({},M,await this.loadData()),this.addSettingTab(new p(this.app,this)),this.registerEvent(this.app.vault.on("modify",t=>{t instanceof n.TFile&&t.extension==="md"&&this.handleModify(t)}))}handleModify(t){if(this.processingFiles.has(t.path)){this.processingFiles.delete(t.path);return}this.processingFiles.add(t.path),this.app.fileManager.processFrontMatter(t,i=>{let a=new Date().toISOString().split("T")[0],r=this.settings.propertyName;i[r]?Array.isArray(i[r])||(i[r]=[String(i[r])]):i[r]=[];let g=i[r].map(h=>String(h));g.includes(a)||(i[r]=[...g,a])}).catch(i=>{this.processingFiles.delete(t.path),console.error("[modified-date-tracker] frontmatter update failed:",i)})}},p=class extends n.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),new n.Setting(e).setName("Frontmatter property name").setDesc("The YAML key where modified dates are stored (default: Modified)").addText(t=>t.setPlaceholder("Modified").setValue(this.plugin.settings.propertyName).onChange(async i=>{this.plugin.settings.propertyName=i.trim()||"Modified",await this.plugin.saveData(this.plugin.settings)}))}};
